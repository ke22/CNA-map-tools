# GenAI 新闻地图自动生成功能使用指南

## 功能概述

这个功能允许你粘贴新闻文章，AI 会自动：
1. 提取主要标注地区（国家、城市、区域）
2. 提取地点标记（具体位置）
3. 生成地图设计建议
4. 自动在地图上生成标记和着色

## 使用步骤

### 第一步：准备新闻文本
在 "AI Assistant" 区域的文本框中粘贴新闻文章内容。

### 第二步：分析新闻
点击 "AI 分析新闻" 按钮，系统会：
- 调用 Gemini AI 分析文本
- 提取所有地理位置信息
- 解析坐标（如果文本中包含）
- 生成地图设计建议

### 第三步：预览结果
分析完成后，会显示：
- **地图设计建议**：建议的地图样式、缩放级别、标题等
- **主要标注地区**：需要着色的区域列表（带颜色、优先级、原因）
- **地点标记**：需要添加标记的位置列表（带坐标、上下文）

### 第四步：应用到地图
点击 "应用到地图" 按钮，系统会：
- 自动为标注地区着色
- 自动添加地点标记
- 自动应用地图样式（如果建议）
- 自动飞行到主要位置

## 功能特性

### 智能提取
- 自动识别国家、城市、具体地址
- 自动提取坐标（如果文本中包含）
- 根据重要性设置优先级

### 地图设计建议
- 分析新闻主题，建议合适的地图样式
- 建议最佳缩放级别
- 建议地图中心点
- 提供标题和说明文字

### 自动生成
- 批量处理多个地区和地点
- 根据优先级自动选择颜色
- 自动解析缺少的坐标
- 错误处理和重试机制

## 配置要求

在 `config.js` 中配置 Gemini API：

```javascript
GEMINI: {
    API_KEY: 'your-api-key-here',
    MODEL: 'gemini-pro',
    ENABLED: true
}
```

## 示例

### 输入文本
```
台北市政府今天宣布新政策。活动在台北市中心举行，坐标 25.0330, 121.5654。
这次政策涉及整个台湾地区，特别关注台北市的发展。
```

### 提取结果
- **标注地区**：台湾（国家，蓝色）、台北市（城市，绿色）
- **地点标记**：台北（25.0330, 121.5654）
- **地图建议**：标准样式，缩放级别 10，中心点在台北

## 注意事项

1. 确保 Gemini API 密钥已配置且有效
2. 网络连接正常（需要访问 Gemini API）
3. 坐标解析可能需要一些时间（自动调用 Mapbox Geocoding API）
4. 某些地区名称可能需要手动匹配（系统会自动尝试）

## 故障排除

- **API 错误**：检查 API 密钥是否正确
- **坐标未解析**：检查地点名称是否正确，或手动添加坐标
- **地区未找到**：可能需要手动点击地图选择该地区

