# 标记缩放功能实现

## 功能描述

当缩放地图时，标记会根据缩放级别按比例调整大小：
- **Zoom Out（缩小）**：标记变小
- **Zoom In（放大）**：标记变大

这样可以确保标记在不同缩放级别下保持合适的视觉大小。

## 实现细节

### 1. 缩放比例计算

**基准缩放级别**：zoom 10（标记正常大小）

**缩放公式**：
- 使用指数缩放：`scale = 2^((currentZoom - baseZoom) / 4)`
- 缩放范围限制：0.2x 到 2.0x

**示例**：
- Zoom 3：约 0.3x（缩小）
- Zoom 10：1.0x（正常大小）
- Zoom 15：约 1.8x（放大）

### 2. 事件监听

监听两个地图事件：
- `zoom`：缩放过程中实时更新
- `zoomend`：缩放结束后最终更新

### 3. 标记更新

- 保留原始变换（pin 形状的旋转）
- 应用缩放变换
- 更新所有标记的 CSS transform
- 存储当前缩放值供 hover 效果使用

### 4. Hover 效果适配

- Hover 效果现在考虑当前缩放级别
- 在现有缩放基础上再放大 10%

## 修改的文件

1. **js/app-enhanced.js**
   - 添加 `updateMarkersScale()` 函数
   - 添加 zoom 事件监听器
   - 在添加标记时应用初始缩放
   - 在更新标记图标时应用缩放

2. **js/utils/marker-icons-apple.js**
   - 更新 hover 效果以考虑当前缩放级别

## 测试建议

1. 添加标记到地图
2. 缩放地图（放大和缩小）
3. 观察标记大小变化
4. 验证标记位置保持准确
5. 测试 hover 效果是否正常工作

## 预期行为

- ✅ Zoom out 时标记变小
- ✅ Zoom in 时标记变大
- ✅ 标记位置保持准确（anchor 点不变）
- ✅ 缩放平滑过渡
- ✅ Hover 效果正常工作

**功能已完成！** ✅

