# AI 助手功能说明

## 功能概述

AI 助手可以自动分析新闻文本，并提取：
1. **标注地区 (Areas)** - 自动在地图上着色
2. **地点标记 (Locations)** - 自动添加标记
3. **地图设计建议** - 自动应用地图样式

## 工作流程

### 1. 分析新闻文本
- 粘贴新闻文章
- 点击 "AI 分析新闻"
- 等待 AI 提取地理信息

### 2. 预览提取结果
AI 会显示：
- 🗺️ 地图设计建议（样式、缩放级别、标题）
- 🎨 主要标注地区（需要着色的区域，带颜色和优先级）
- 📍 地点标记（需要添加标记的位置，带坐标）

### 3. 应用到地图
点击 "应用到地图" 按钮后，系统会：

#### 自动着色区域 (Areas)
- 根据 AI 提取的区域名称和类型
- 使用 AI 建议的颜色（或默认颜色）
- 自动查找并应用颜色到对应的国家/省/市

#### 自动添加标记 (Markers)
- 根据 AI 提取的地点名称
- 自动解析坐标（如果文本中没有坐标）
- 使用优先级决定标记颜色
  - 优先级 1 = 红色（最重要）
  - 优先级 2 = 橙色
  - 优先级 3 = 黄色
  - 优先级 4 = 绿色
  - 优先级 5 = 蓝色（普通）

#### 自动应用地图设计
- 应用建议的地图样式
- 调整缩放级别
- 飞行到主要位置

## 示例

### 输入新闻文本：
```
台北市政府今天宣布新政策。活动在台北市中心举行，坐标 25.0330, 121.5654。
这次政策涉及整个台湾地区，特别关注台北市的发展。
```

### AI 提取结果：
- **标注地区**: 台湾（国家，蓝色）、台北市（城市，绿色）
- **地点标记**: 台北（25.0330, 121.5654）
- **地图建议**: 标准样式，缩放级别 10，中心点在台北

### 应用到地图后：
- ✅ 台湾整个区域被着色为蓝色
- ✅ 台北市区域被着色为绿色
- ✅ 在台北坐标位置添加红色标记（优先级 1）
- ✅ 地图自动飞行到台北位置

## 故障排除

如果"应用到地图"按钮没有响应：

1. **检查控制台错误** (F12 → Console)
   - 查看是否有错误信息
   - 检查函数是否被调用

2. **检查地图是否就绪**
   - 确保地图已完全加载
   - 等待地图初始化完成

3. **检查结果是否存在**
   - 确保 AI 分析已完成
   - 确保有可应用的结果

## 技术细节

- `applyAIResultsToMap()` - 应用结果到地图的主要函数
- `applyColorToArea()` - 着色区域函数
- `addMarker()` - 添加标记函数
- `findAreaIdByName()` - 查找区域 ID 函数

所有函数都已导出到 `window` 对象，可以在控制台中调用测试。
